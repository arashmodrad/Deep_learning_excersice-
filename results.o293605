Python version:3.7.4 (default, Nov 22 2019, 21:31:39) 
[GCC 7.3.0]

TF version:1.15.0, Keras version:2.2.4

train_x.shape:(50000, 784) and train_y.shape:(50000,)
val_x.shape:(10000, 784) and val_y.shape:(10000,)
images are 28*28 = 784 vectors

train_x.shape:(60000, 784)
train_y.shape:(60000,)

train_x[0].shape:60000
train_x[1].shape:784

train_x.shape:(60000, 28, 28, 1)
train_y.shape:(60000,)
train_x[59999].shape: (28, 28, 1)

test_x.shape:(10000, 784)
test_x.shape:(10000, 28, 28, 1)
test_y.shape:(10000,)
train_y.shape:(60000, 10)
test_y.shape:(10000, 10)
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 24, 24, 32)        832       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 12, 12, 32)        0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 10, 10, 64)        18496     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 5, 5, 64)          0         
_________________________________________________________________
flatten (Flatten)            (None, 1600)              0         
_________________________________________________________________
dense (Dense)                (None, 200)               320200    
_________________________________________________________________
dense_1 (Dense)              (None, 10)                2010      
=================================================================
Total params: 341,538
Trainable params: 341,538
Non-trainable params: 0
_________________________________________________________________
None
Train on 54000 samples, validate on 6000 samples
Epoch 1/3
   32/54000 [..............................] - ETA: 1:14:16 - loss: 2.2970 - acc: 0.1562  288/54000 [..............................] - ETA: 8:22 - loss: 2.2286 - acc: 0.2361     864/54000 [..............................] - ETA: 2:48 - loss: 1.8941 - acc: 0.4514 1440/54000 [..............................] - ETA: 1:42 - loss: 1.4887 - acc: 0.5604 2048/54000 [>.............................] - ETA: 1:12 - loss: 1.1996 - acc: 0.6465 2656/54000 [>.............................] - ETA: 56s - loss: 1.0248 - acc: 0.6962  3264/54000 [>.............................] - ETA: 45s - loss: 0.8992 - acc: 0.7338 3808/54000 [=>............................] - ETA: 39s - loss: 0.8240 - acc: 0.7545 4384/54000 [=>............................] - ETA: 34s - loss: 0.7518 - acc: 0.7742 4992/54000 [=>............................] - ETA: 30s - loss: 0.6908 - acc: 0.7931 5600/54000 [==>...........................] - ETA: 27s - loss: 0.6410 - acc: 0.8066 6208/54000 [==>...........................] - ETA: 24s - loss: 0.5958 - acc: 0.8204 6784/54000 [==>...........................] - ETA: 22s - loss: 0.5608 - acc: 0.8314 7392/54000 [===>..........................] - ETA: 20s - loss: 0.5330 - acc: 0.8394 8000/54000 [===>..........................] - ETA: 19s - loss: 0.5110 - acc: 0.8462 8608/54000 [===>..........................] - ETA: 18s - loss: 0.4871 - acc: 0.8542 9184/54000 [====>.........................] - ETA: 16s - loss: 0.4667 - acc: 0.8604 9792/54000 [====>.........................] - ETA: 15s - loss: 0.4464 - acc: 0.865910400/54000 [====>.........................] - ETA: 14s - loss: 0.4325 - acc: 0.869910912/54000 [=====>........................] - ETA: 14s - loss: 0.4205 - acc: 0.873311520/54000 [=====>........................] - ETA: 13s - loss: 0.4053 - acc: 0.877312128/54000 [=====>........................] - ETA: 12s - loss: 0.3925 - acc: 0.881412736/54000 [======>.......................] - ETA: 12s - loss: 0.3789 - acc: 0.885413312/54000 [======>.......................] - ETA: 11s - loss: 0.3679 - acc: 0.888513920/54000 [======>.......................] - ETA: 11s - loss: 0.3573 - acc: 0.891714496/54000 [=======>......................] - ETA: 10s - loss: 0.3475 - acc: 0.895115104/54000 [=======>......................] - ETA: 10s - loss: 0.3379 - acc: 0.898215712/54000 [=======>......................] - ETA: 9s - loss: 0.3290 - acc: 0.9012 16320/54000 [========>.....................] - ETA: 9s - loss: 0.3220 - acc: 0.902916928/54000 [========>.....................] - ETA: 9s - loss: 0.3150 - acc: 0.905017536/54000 [========>.....................] - ETA: 8s - loss: 0.3078 - acc: 0.906918112/54000 [=========>....................] - ETA: 8s - loss: 0.3014 - acc: 0.909018720/54000 [=========>....................] - ETA: 8s - loss: 0.2942 - acc: 0.911219296/54000 [=========>....................] - ETA: 7s - loss: 0.2885 - acc: 0.913019872/54000 [==========>...................] - ETA: 7s - loss: 0.2823 - acc: 0.914920480/54000 [==========>...................] - ETA: 7s - loss: 0.2771 - acc: 0.916521088/54000 [==========>...................] - ETA: 7s - loss: 0.2724 - acc: 0.917921696/54000 [===========>..................] - ETA: 6s - loss: 0.2676 - acc: 0.919522304/54000 [===========>..................] - ETA: 6s - loss: 0.2639 - acc: 0.920622912/54000 [===========>..................] - ETA: 6s - loss: 0.2598 - acc: 0.921823520/54000 [============>.................] - ETA: 6s - loss: 0.2550 - acc: 0.923324128/54000 [============>.................] - ETA: 5s - loss: 0.2504 - acc: 0.924824736/54000 [============>.................] - ETA: 5s - loss: 0.2465 - acc: 0.925825344/54000 [=============>................] - ETA: 5s - loss: 0.2428 - acc: 0.926925952/54000 [=============>................] - ETA: 5s - loss: 0.2390 - acc: 0.928126528/54000 [=============>................] - ETA: 5s - loss: 0.2361 - acc: 0.928827136/54000 [==============>...............] - ETA: 4s - loss: 0.2327 - acc: 0.929927744/54000 [==============>...............] - ETA: 4s - loss: 0.2295 - acc: 0.931028352/54000 [==============>...............] - ETA: 4s - loss: 0.2258 - acc: 0.932128960/54000 [===============>..............] - ETA: 4s - loss: 0.2226 - acc: 0.933029536/54000 [===============>..............] - ETA: 4s - loss: 0.2197 - acc: 0.933930144/54000 [===============>..............] - ETA: 4s - loss: 0.2165 - acc: 0.934730752/54000 [================>.............] - ETA: 4s - loss: 0.2141 - acc: 0.935631360/54000 [================>.............] - ETA: 3s - loss: 0.2113 - acc: 0.936431968/54000 [================>.............] - ETA: 3s - loss: 0.2087 - acc: 0.937132576/54000 [=================>............] - ETA: 3s - loss: 0.2064 - acc: 0.937833184/54000 [=================>............] - ETA: 3s - loss: 0.2041 - acc: 0.938533792/54000 [=================>............] - ETA: 3s - loss: 0.2025 - acc: 0.939034400/54000 [==================>...........] - ETA: 3s - loss: 0.1999 - acc: 0.939835008/54000 [==================>...........] - ETA: 3s - loss: 0.1978 - acc: 0.940435584/54000 [==================>...........] - ETA: 2s - loss: 0.1953 - acc: 0.941136192/54000 [===================>..........] - ETA: 2s - loss: 0.1934 - acc: 0.941636800/54000 [===================>..........] - ETA: 2s - loss: 0.1914 - acc: 0.942237408/54000 [===================>..........] - ETA: 2s - loss: 0.1893 - acc: 0.942838016/54000 [====================>.........] - ETA: 2s - loss: 0.1876 - acc: 0.943338624/54000 [====================>.........] - ETA: 2s - loss: 0.1857 - acc: 0.943839232/54000 [====================>.........] - ETA: 2s - loss: 0.1838 - acc: 0.944439840/54000 [=====================>........] - ETA: 2s - loss: 0.1825 - acc: 0.944840448/54000 [=====================>........] - ETA: 2s - loss: 0.1817 - acc: 0.945141056/54000 [=====================>........] - ETA: 1s - loss: 0.1806 - acc: 0.945441664/54000 [======================>.......] - ETA: 1s - loss: 0.1793 - acc: 0.945842272/54000 [======================>.......] - ETA: 1s - loss: 0.1775 - acc: 0.946442880/54000 [======================>.......] - ETA: 1s - loss: 0.1756 - acc: 0.946943488/54000 [=======================>......] - ETA: 1s - loss: 0.1739 - acc: 0.947444096/54000 [=======================>......] - ETA: 1s - loss: 0.1725 - acc: 0.947844704/54000 [=======================>......] - ETA: 1s - loss: 0.1713 - acc: 0.948345344/54000 [========================>.....] - ETA: 1s - loss: 0.1703 - acc: 0.948745952/54000 [========================>.....] - ETA: 1s - loss: 0.1691 - acc: 0.949146560/54000 [========================>.....] - ETA: 1s - loss: 0.1676 - acc: 0.949547168/54000 [=========================>....] - ETA: 0s - loss: 0.1667 - acc: 0.949847776/54000 [=========================>....] - ETA: 0s - loss: 0.1658 - acc: 0.950048384/54000 [=========================>....] - ETA: 0s - loss: 0.1646 - acc: 0.950348992/54000 [==========================>...] - ETA: 0s - loss: 0.1634 - acc: 0.950649600/54000 [==========================>...] - ETA: 0s - loss: 0.1624 - acc: 0.950950208/54000 [==========================>...] - ETA: 0s - loss: 0.1613 - acc: 0.951250816/54000 [===========================>..] - ETA: 0s - loss: 0.1600 - acc: 0.951551424/54000 [===========================>..] - ETA: 0s - loss: 0.1589 - acc: 0.951852000/54000 [===========================>..] - ETA: 0s - loss: 0.1576 - acc: 0.952252608/54000 [============================>.] - ETA: 0s - loss: 0.1563 - acc: 0.952653216/54000 [============================>.] - ETA: 0s - loss: 0.1551 - acc: 0.953053792/54000 [============================>.] - ETA: 0s - loss: 0.1544 - acc: 0.9532
Epoch 00001: val_acc improved from -inf to 0.98550, saving model to outputs/cnn_weights_best_25794_.hdf5
54000/54000 [==============================] - 9s 169us/sample - loss: 0.1539 - acc: 0.9534 - val_loss: 0.0528 - val_acc: 0.9855
Epoch 2/3
   32/54000 [..............................] - ETA: 10s - loss: 0.0592 - acc: 0.9688  608/54000 [..............................] - ETA: 4s - loss: 0.0538 - acc: 0.9803  1216/54000 [..............................] - ETA: 4s - loss: 0.0618 - acc: 0.9786 1824/54000 [>.............................] - ETA: 4s - loss: 0.0620 - acc: 0.9792 2432/54000 [>.............................] - ETA: 4s - loss: 0.0530 - acc: 0.9827 3040/54000 [>.............................] - ETA: 4s - loss: 0.0521 - acc: 0.9836 3680/54000 [=>............................] - ETA: 4s - loss: 0.0509 - acc: 0.9842 4288/54000 [=>............................] - ETA: 4s - loss: 0.0514 - acc: 0.9846 4896/54000 [=>............................] - ETA: 4s - loss: 0.0510 - acc: 0.9847 5504/54000 [==>...........................] - ETA: 4s - loss: 0.0496 - acc: 0.9851 6112/54000 [==>...........................] - ETA: 4s - loss: 0.0485 - acc: 0.9851 6752/54000 [==>...........................] - ETA: 3s - loss: 0.0488 - acc: 0.9850 7360/54000 [===>..........................] - ETA: 3s - loss: 0.0502 - acc: 0.9846 7968/54000 [===>..........................] - ETA: 3s - loss: 0.0497 - acc: 0.9849 8576/54000 [===>..........................] - ETA: 3s - loss: 0.0492 - acc: 0.9851 9184/54000 [====>.........................] - ETA: 3s - loss: 0.0489 - acc: 0.9851 9792/54000 [====>.........................] - ETA: 3s - loss: 0.0484 - acc: 0.985210400/54000 [====>.........................] - ETA: 3s - loss: 0.0479 - acc: 0.985511008/54000 [=====>........................] - ETA: 3s - loss: 0.0477 - acc: 0.985611616/54000 [=====>........................] - ETA: 3s - loss: 0.0479 - acc: 0.985112224/54000 [=====>........................] - ETA: 3s - loss: 0.0481 - acc: 0.985112832/54000 [======>.......................] - ETA: 3s - loss: 0.0495 - acc: 0.984813440/54000 [======>.......................] - ETA: 3s - loss: 0.0501 - acc: 0.984514048/54000 [======>.......................] - ETA: 3s - loss: 0.0495 - acc: 0.984814688/54000 [=======>......................] - ETA: 3s - loss: 0.0506 - acc: 0.984415296/54000 [=======>......................] - ETA: 3s - loss: 0.0504 - acc: 0.984515904/54000 [=======>......................] - ETA: 3s - loss: 0.0507 - acc: 0.984416512/54000 [========>.....................] - ETA: 3s - loss: 0.0506 - acc: 0.984317120/54000 [========>.....................] - ETA: 3s - loss: 0.0506 - acc: 0.984017760/54000 [========>.....................] - ETA: 3s - loss: 0.0503 - acc: 0.984118400/54000 [=========>....................] - ETA: 2s - loss: 0.0498 - acc: 0.984219040/54000 [=========>....................] - ETA: 2s - loss: 0.0497 - acc: 0.984319680/54000 [=========>....................] - ETA: 2s - loss: 0.0495 - acc: 0.984320352/54000 [==========>...................] - ETA: 2s - loss: 0.0496 - acc: 0.984220992/54000 [==========>...................] - ETA: 2s - loss: 0.0499 - acc: 0.984221632/54000 [===========>..................] - ETA: 2s - loss: 0.0503 - acc: 0.984122272/54000 [===========>..................] - ETA: 2s - loss: 0.0504 - acc: 0.984122912/54000 [===========>..................] - ETA: 2s - loss: 0.0501 - acc: 0.984223552/54000 [============>.................] - ETA: 2s - loss: 0.0502 - acc: 0.984124160/54000 [============>.................] - ETA: 2s - loss: 0.0495 - acc: 0.984424768/54000 [============>.................] - ETA: 2s - loss: 0.0495 - acc: 0.984325312/54000 [=============>................] - ETA: 2s - loss: 0.0490 - acc: 0.984525920/54000 [=============>................] - ETA: 2s - loss: 0.0488 - acc: 0.984626528/54000 [=============>................] - ETA: 2s - loss: 0.0489 - acc: 0.984527104/54000 [==============>...............] - ETA: 2s - loss: 0.0487 - acc: 0.984627680/54000 [==============>...............] - ETA: 2s - loss: 0.0487 - acc: 0.984628288/54000 [==============>...............] - ETA: 2s - loss: 0.0484 - acc: 0.984728896/54000 [===============>..............] - ETA: 2s - loss: 0.0481 - acc: 0.984829472/54000 [===============>..............] - ETA: 2s - loss: 0.0480 - acc: 0.984830048/54000 [===============>..............] - ETA: 2s - loss: 0.0479 - acc: 0.984830656/54000 [================>.............] - ETA: 1s - loss: 0.0478 - acc: 0.984831264/54000 [================>.............] - ETA: 1s - loss: 0.0479 - acc: 0.984731872/54000 [================>.............] - ETA: 1s - loss: 0.0477 - acc: 0.984832448/54000 [=================>............] - ETA: 1s - loss: 0.0475 - acc: 0.984933056/54000 [=================>............] - ETA: 1s - loss: 0.0474 - acc: 0.984933632/54000 [=================>............] - ETA: 1s - loss: 0.0476 - acc: 0.984834240/54000 [==================>...........] - ETA: 1s - loss: 0.0471 - acc: 0.985034848/54000 [==================>...........] - ETA: 1s - loss: 0.0471 - acc: 0.985035456/54000 [==================>...........] - ETA: 1s - loss: 0.0469 - acc: 0.985036064/54000 [===================>..........] - ETA: 1s - loss: 0.0469 - acc: 0.985136672/54000 [===================>..........] - ETA: 1s - loss: 0.0467 - acc: 0.985137280/54000 [===================>..........] - ETA: 1s - loss: 0.0466 - acc: 0.985137856/54000 [====================>.........] - ETA: 1s - loss: 0.0463 - acc: 0.985238464/54000 [====================>.........] - ETA: 1s - loss: 0.0464 - acc: 0.985239104/54000 [====================>.........] - ETA: 1s - loss: 0.0467 - acc: 0.985139712/54000 [=====================>........] - ETA: 1s - loss: 0.0468 - acc: 0.985040352/54000 [=====================>........] - ETA: 1s - loss: 0.0470 - acc: 0.985040960/54000 [=====================>........] - ETA: 1s - loss: 0.0469 - acc: 0.985041568/54000 [======================>.......] - ETA: 1s - loss: 0.0471 - acc: 0.985042176/54000 [======================>.......] - ETA: 0s - loss: 0.0472 - acc: 0.985042784/54000 [======================>.......] - ETA: 0s - loss: 0.0473 - acc: 0.985043392/54000 [=======================>......] - ETA: 0s - loss: 0.0474 - acc: 0.985044000/54000 [=======================>......] - ETA: 0s - loss: 0.0473 - acc: 0.985144608/54000 [=======================>......] - ETA: 0s - loss: 0.0476 - acc: 0.985145216/54000 [========================>.....] - ETA: 0s - loss: 0.0476 - acc: 0.985045824/54000 [========================>.....] - ETA: 0s - loss: 0.0474 - acc: 0.985146432/54000 [========================>.....] - ETA: 0s - loss: 0.0476 - acc: 0.984947040/54000 [=========================>....] - ETA: 0s - loss: 0.0474 - acc: 0.985047648/54000 [=========================>....] - ETA: 0s - loss: 0.0474 - acc: 0.985048256/54000 [=========================>....] - ETA: 0s - loss: 0.0474 - acc: 0.985048864/54000 [==========================>...] - ETA: 0s - loss: 0.0474 - acc: 0.985049504/54000 [==========================>...] - ETA: 0s - loss: 0.0473 - acc: 0.985050112/54000 [==========================>...] - ETA: 0s - loss: 0.0473 - acc: 0.985050752/54000 [===========================>..] - ETA: 0s - loss: 0.0472 - acc: 0.985151328/54000 [===========================>..] - ETA: 0s - loss: 0.0473 - acc: 0.985051936/54000 [===========================>..] - ETA: 0s - loss: 0.0473 - acc: 0.985152576/54000 [============================>.] - ETA: 0s - loss: 0.0473 - acc: 0.985153184/54000 [============================>.] - ETA: 0s - loss: 0.0472 - acc: 0.985153792/54000 [============================>.] - ETA: 0s - loss: 0.0471 - acc: 0.9851
Epoch 00002: val_acc improved from 0.98550 to 0.98817, saving model to outputs/cnn_weights_best_25794_.hdf5
54000/54000 [==============================] - 5s 91us/sample - loss: 0.0472 - acc: 0.9851 - val_loss: 0.0385 - val_acc: 0.9882
Epoch 3/3
   32/54000 [..............................] - ETA: 9s - loss: 0.0140 - acc: 1.0000  672/54000 [..............................] - ETA: 4s - loss: 0.0277 - acc: 0.9911 1280/54000 [..............................] - ETA: 4s - loss: 0.0285 - acc: 0.9930 1888/54000 [>.............................] - ETA: 4s - loss: 0.0329 - acc: 0.9899 2496/54000 [>.............................] - ETA: 4s - loss: 0.0324 - acc: 0.9904 3136/54000 [>.............................] - ETA: 4s - loss: 0.0364 - acc: 0.9895 3776/54000 [=>............................] - ETA: 4s - loss: 0.0326 - acc: 0.9907 4416/54000 [=>............................] - ETA: 4s - loss: 0.0318 - acc: 0.9909 5056/54000 [=>............................] - ETA: 4s - loss: 0.0291 - acc: 0.9919 5696/54000 [==>...........................] - ETA: 3s - loss: 0.0294 - acc: 0.9923 6336/54000 [==>...........................] - ETA: 3s - loss: 0.0282 - acc: 0.9926 6976/54000 [==>...........................] - ETA: 3s - loss: 0.0291 - acc: 0.9924 7616/54000 [===>..........................] - ETA: 3s - loss: 0.0303 - acc: 0.9923 8256/54000 [===>..........................] - ETA: 3s - loss: 0.0293 - acc: 0.9924 8896/54000 [===>..........................] - ETA: 3s - loss: 0.0304 - acc: 0.9915 9536/54000 [====>.........................] - ETA: 3s - loss: 0.0304 - acc: 0.991210176/54000 [====>.........................] - ETA: 3s - loss: 0.0308 - acc: 0.991010784/54000 [====>.........................] - ETA: 3s - loss: 0.0316 - acc: 0.990811424/54000 [=====>........................] - ETA: 3s - loss: 0.0314 - acc: 0.990912032/54000 [=====>........................] - ETA: 3s - loss: 0.0315 - acc: 0.990912672/54000 [======>.......................] - ETA: 3s - loss: 0.0317 - acc: 0.990813312/54000 [======>.......................] - ETA: 3s - loss: 0.0318 - acc: 0.990613952/54000 [======>.......................] - ETA: 3s - loss: 0.0315 - acc: 0.990714560/54000 [=======>......................] - ETA: 3s - loss: 0.0323 - acc: 0.990615168/54000 [=======>......................] - ETA: 3s - loss: 0.0323 - acc: 0.990615808/54000 [=======>......................] - ETA: 3s - loss: 0.0318 - acc: 0.990816416/54000 [========>.....................] - ETA: 3s - loss: 0.0318 - acc: 0.990717056/54000 [========>.....................] - ETA: 3s - loss: 0.0321 - acc: 0.990517664/54000 [========>.....................] - ETA: 2s - loss: 0.0322 - acc: 0.990418272/54000 [=========>....................] - ETA: 2s - loss: 0.0323 - acc: 0.990418880/54000 [=========>....................] - ETA: 2s - loss: 0.0317 - acc: 0.990519488/54000 [=========>....................] - ETA: 2s - loss: 0.0312 - acc: 0.990620096/54000 [==========>...................] - ETA: 2s - loss: 0.0311 - acc: 0.990620704/54000 [==========>...................] - ETA: 2s - loss: 0.0308 - acc: 0.990621312/54000 [==========>...................] - ETA: 2s - loss: 0.0313 - acc: 0.990521952/54000 [===========>..................] - ETA: 2s - loss: 0.0311 - acc: 0.990522592/54000 [===========>..................] - ETA: 2s - loss: 0.0308 - acc: 0.990723200/54000 [===========>..................] - ETA: 2s - loss: 0.0311 - acc: 0.990523808/54000 [============>.................] - ETA: 2s - loss: 0.0311 - acc: 0.990524448/54000 [============>.................] - ETA: 2s - loss: 0.0310 - acc: 0.990525056/54000 [============>.................] - ETA: 2s - loss: 0.0311 - acc: 0.990525664/54000 [=============>................] - ETA: 2s - loss: 0.0313 - acc: 0.990526272/54000 [=============>................] - ETA: 2s - loss: 0.0315 - acc: 0.990326880/54000 [=============>................] - ETA: 2s - loss: 0.0319 - acc: 0.990327488/54000 [==============>...............] - ETA: 2s - loss: 0.0323 - acc: 0.990228096/54000 [==============>...............] - ETA: 2s - loss: 0.0321 - acc: 0.990228704/54000 [==============>...............] - ETA: 2s - loss: 0.0319 - acc: 0.990329344/54000 [===============>..............] - ETA: 2s - loss: 0.0317 - acc: 0.990329952/54000 [===============>..............] - ETA: 1s - loss: 0.0321 - acc: 0.990330560/54000 [===============>..............] - ETA: 1s - loss: 0.0319 - acc: 0.990331168/54000 [================>.............] - ETA: 1s - loss: 0.0316 - acc: 0.990431776/54000 [================>.............] - ETA: 1s - loss: 0.0315 - acc: 0.990432384/54000 [================>.............] - ETA: 1s - loss: 0.0313 - acc: 0.990533024/54000 [=================>............] - ETA: 1s - loss: 0.0312 - acc: 0.990533632/54000 [=================>............] - ETA: 1s - loss: 0.0308 - acc: 0.990634240/54000 [==================>...........] - ETA: 1s - loss: 0.0307 - acc: 0.990734848/54000 [==================>...........] - ETA: 1s - loss: 0.0305 - acc: 0.990835456/54000 [==================>...........] - ETA: 1s - loss: 0.0303 - acc: 0.990936064/54000 [===================>..........] - ETA: 1s - loss: 0.0303 - acc: 0.990936672/54000 [===================>..........] - ETA: 1s - loss: 0.0301 - acc: 0.991037312/54000 [===================>..........] - ETA: 1s - loss: 0.0302 - acc: 0.990937952/54000 [====================>.........] - ETA: 1s - loss: 0.0303 - acc: 0.990838560/54000 [====================>.........] - ETA: 1s - loss: 0.0304 - acc: 0.990739200/54000 [====================>.........] - ETA: 1s - loss: 0.0305 - acc: 0.990739840/54000 [=====================>........] - ETA: 1s - loss: 0.0303 - acc: 0.990740480/54000 [=====================>........] - ETA: 1s - loss: 0.0303 - acc: 0.990741088/54000 [=====================>........] - ETA: 1s - loss: 0.0306 - acc: 0.990741728/54000 [======================>.......] - ETA: 1s - loss: 0.0306 - acc: 0.990642368/54000 [======================>.......] - ETA: 0s - loss: 0.0310 - acc: 0.990542976/54000 [======================>.......] - ETA: 0s - loss: 0.0309 - acc: 0.990543616/54000 [=======================>......] - ETA: 0s - loss: 0.0309 - acc: 0.990444224/54000 [=======================>......] - ETA: 0s - loss: 0.0308 - acc: 0.990544864/54000 [=======================>......] - ETA: 0s - loss: 0.0308 - acc: 0.990545504/54000 [========================>.....] - ETA: 0s - loss: 0.0308 - acc: 0.990546144/54000 [========================>.....] - ETA: 0s - loss: 0.0308 - acc: 0.990546784/54000 [========================>.....] - ETA: 0s - loss: 0.0309 - acc: 0.990547392/54000 [=========================>....] - ETA: 0s - loss: 0.0306 - acc: 0.990548032/54000 [=========================>....] - ETA: 0s - loss: 0.0307 - acc: 0.990548672/54000 [==========================>...] - ETA: 0s - loss: 0.0308 - acc: 0.990449312/54000 [==========================>...] - ETA: 0s - loss: 0.0309 - acc: 0.990449952/54000 [==========================>...] - ETA: 0s - loss: 0.0314 - acc: 0.990350528/54000 [===========================>..] - ETA: 0s - loss: 0.0316 - acc: 0.990451168/54000 [===========================>..] - ETA: 0s - loss: 0.0316 - acc: 0.990351808/54000 [===========================>..] - ETA: 0s - loss: 0.0314 - acc: 0.990352448/54000 [============================>.] - ETA: 0s - loss: 0.0315 - acc: 0.990253088/54000 [============================>.] - ETA: 0s - loss: 0.0315 - acc: 0.990353728/54000 [============================>.] - ETA: 0s - loss: 0.0316 - acc: 0.9902
Epoch 00003: val_acc improved from 0.98817 to 0.98967, saving model to outputs/cnn_weights_best_25794_.hdf5
54000/54000 [==============================] - 5s 89us/sample - loss: 0.0317 - acc: 0.9902 - val_loss: 0.0351 - val_acc: 0.9897
Test result of the final epoch

10000/10000 [==============================] - 1s 94us/sample - loss: 0.0324 - acc: 0.9895
Test accuracy of the epoch that resulted  in the best validation accuracy

10000/10000 [==============================] - 0s 6us/sample - loss: 0.0324 - acc: 0.9895
pickle file written to:outputs/cnn_model_history_25794_.pkl
Total time taken:21.745014905929565
